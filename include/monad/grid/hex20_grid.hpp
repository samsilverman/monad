#pragma once

#include "monad/grid/grid_3d_base.hpp"
#include "monad/fem/element/hex20.hpp"

namespace monad {

    /**
     * @brief 2D grid mesh of 4-node quadrilaterl (Hex20) elements.
     *
     * Example 3x2x2 grid:
     *
     * ```text
     *               oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€o
     *              /         /         /         /â”‚
     *             o         o         o         o â”‚
     *            /         /         /         /  o
     *           oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€o   â”‚
     *          /         /         /         /â”‚   â”‚
     *         o         o         o         o â”‚   o
     *        /         /         /         /  o  /â”‚
     *       oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€o   â”‚ o â”‚
     *       â”‚         â”‚         â”‚         â”‚   â”‚/  o
     *       â”‚         â”‚         â”‚         â”‚   o   â”‚
     *       o         o         o         o  /â”‚   â”‚
     *       â”‚         â”‚         â”‚         â”‚ o â”‚   o
     *       â”‚         â”‚         â”‚         â”‚/  o  /
     *       oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€o   â”‚ o
     *       â”‚         â”‚         â”‚         â”‚   â”‚/
     *       â”‚         â”‚         â”‚         â”‚   o
     *       o         o         o         o  /
     *       â”‚         â”‚         â”‚         â”‚ o
     *       â”‚         â”‚         â”‚         â”‚/
     *       oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€oâ”€â”€â”€â”€o
     * ```
     *
     * Global axes:
     *
     * - x runs leftâ†’right.
     *
     * - y runs frontâ†’back.
     *
     * - z runs bottomâ†’top.
     */
    class Hex20Grid : public Grid3dBase<Hex20Grid, fem::Hex20> {
    public:
        using Grid3dBase<Hex20Grid, fem::Hex20>::Grid3dBase;

        /// @brief Number of nodes.
        std::size_t numNodes() const noexcept;

        /// @brief Number of periodic nodes.
        std::size_t numPeriodicNodes() const noexcept;

        /**
         * @brief Coordinates for a specific node.
         *
         * Example 3x2x2 grid:
         *
         * ```text
         *               32â”€â”€â”€60â”€â”€â”€33â”€â”€â”€61â”€â”€â”€34â”€â”€â”€62â”€â”€â”€35
         *              /         /         /         /â”‚
         *             83        84        85        86â”‚
         *            /         /         /         / 110
         *           28â”€â”€â”€57â”€â”€â”€29â”€â”€â”€58â”€â”€â”€30â”€â”€â”€59â”€â”€â”€31  â”‚
         *          /         /         /         /â”‚   â”‚
         *         79        80        81        82â”‚   23
         *        /         /         /         / 106 /â”‚
         *       24â”€â”€â”€54â”€â”€â”€25â”€â”€â”€55â”€â”€â”€26â”€â”€â”€56â”€â”€â”€27  â”‚ 78â”‚
         *       â”‚         â”‚         â”‚         â”‚   â”‚/  98
         *       â”‚         â”‚         â”‚         â”‚   19  â”‚
         *       99       100       101       102 /â”‚   â”‚
         *       â”‚         â”‚         â”‚         â”‚ 74â”‚   11
         *       â”‚         â”‚         â”‚         â”‚/  94 /
         *       12â”€â”€â”€45â”€â”€â”€13â”€â”€â”€46â”€â”€â”€14â”€â”€â”€47â”€â”€â”€15  â”‚ 70
         *       â”‚         â”‚         â”‚         â”‚   â”‚/
         *       â”‚         â”‚         â”‚         â”‚   7
         *       87        88        89        90 /
         *       â”‚         â”‚         â”‚         â”‚ 66
         *       â”‚         â”‚         â”‚         â”‚/
         *       0â”€â”€â”€â”€36â”€â”€â”€1â”€â”€â”€â”€37â”€â”€â”€2â”€â”€â”€â”€38â”€â”€â”€3
         * ```
         *
         * @param[in] index Node index.
         *
         * @returns Coordinates.
         *
         * @throws std::out_of_range if `index` is outside the range [0,`numNodes()`).
         */
        Point node(std::size_t index) const;

        /**
         * @brief Node indices for a specific element.
         *
         * Example 3x2x2 grid:
         *
         * ```text
         *               32â”€â”€â”€60â”€â”€â”€33â”€â”€â”€61â”€â”€â”€34â”€â”€â”€62â”€â”€â”€35
         *              /         /         /         /â”‚
         *             83   ğŸ¿    84   ğŸ·ğŸ¶   85   ğŸ·ğŸ·   86â”‚
         *            /         /         /         / 110
         *           28â”€â”€â”€57â”€â”€â”€29â”€â”€â”€58â”€â”€â”€30â”€â”€â”€59â”€â”€â”€31  â”‚
         *          /         /         /         /â”‚   â”‚
         *         79        80        81        82â”‚   23
         *        /         /         /         / 106 /â”‚
         *       24â”€â”€â”€54â”€â”€â”€25â”€â”€â”€55â”€â”€â”€26â”€â”€â”€56â”€â”€â”€27  â”‚ 78â”‚
         *       â”‚         â”‚         â”‚         â”‚   â”‚/  98
         *       â”‚         â”‚         â”‚         â”‚   19  â”‚
         *       99   ğŸ¼   100   ğŸ½   101   ğŸ¾   102 /â”‚   â”‚
         *       â”‚         â”‚         â”‚         â”‚ 74â”‚   11
         *       â”‚         â”‚         â”‚         â”‚/  94 /
         *       12â”€â”€â”€45â”€â”€â”€13â”€â”€â”€46â”€â”€â”€14â”€â”€â”€47â”€â”€â”€15  â”‚ 70
         *       â”‚         â”‚         â”‚         â”‚   â”‚/
         *       â”‚         â”‚         â”‚         â”‚   7
         *       87   ğŸ¶    88   ğŸ·    89   ğŸ¸    90 /
         *       â”‚         â”‚         â”‚         â”‚ 66
         *       â”‚         â”‚         â”‚         â”‚/
         *       0â”€â”€â”€â”€36â”€â”€â”€1â”€â”€â”€â”€37â”€â”€â”€2â”€â”€â”€â”€38â”€â”€â”€3
         * ```
         *
         * @param[in] index Element index.
         *
         * @returns Node indices.
         *
         * @throws std::out_of_range if `index` is outside the range [0,`numElements()`).
         */
        ElementList element(std::size_t index) const;

        /**
         * @brief Periodic node indices for a specific element.
         *
         * Example 3x2x2 grid:
         *
         * ```text
         *               0â”€â”€â”€â”€12â”€â”€â”€1â”€â”€â”€â”€13â”€â”€â”€2â”€â”€â”€â”€14â”€â”€â”€0
         *              /         /         /         /â”‚
         *             27   ğŸ¿    28   ğŸ·ğŸ¶   29   ğŸ·ğŸ·   27â”‚
         *            /         /         /         /  42
         *           3â”€â”€â”€â”€15â”€â”€â”€4â”€â”€â”€â”€16â”€â”€â”€5â”€â”€â”€â”€17â”€â”€â”€3   â”‚
         *          /         /         /         /â”‚   â”‚
         *         24        25        26        24â”‚   6
         *        /         /         /         /  45 /â”‚
         *       0â”€â”€â”€â”€12â”€â”€â”€1â”€â”€â”€â”€13â”€â”€â”€2â”€â”€â”€â”€14â”€â”€â”€0   â”‚ 33â”‚
         *       â”‚         â”‚         â”‚         â”‚   â”‚/  36
         *       â”‚         â”‚         â”‚         â”‚   9   â”‚
         *       42   ğŸ¼    43   ğŸ½    44   ğŸ¾    42 /â”‚   â”‚
         *       â”‚         â”‚         â”‚         â”‚ 30â”‚   0
         *       â”‚         â”‚         â”‚         â”‚/  39 /
         *       6â”€â”€â”€â”€18â”€â”€â”€7â”€â”€â”€â”€19â”€â”€â”€8â”€â”€â”€â”€20â”€â”€â”€6   â”‚ 27
         *       â”‚         â”‚         â”‚         â”‚   â”‚/
         *       â”‚         â”‚         â”‚         â”‚   3
         *       36   ğŸ¶    37   ğŸ·    38   ğŸ¸    36 /
         *       â”‚         â”‚         â”‚         â”‚ 24
         *       â”‚         â”‚         â”‚         â”‚/
         *       0â”€â”€â”€â”€12â”€â”€â”€1â”€â”€â”€â”€13â”€â”€â”€2â”€â”€â”€â”€14â”€â”€â”€0
         * ```
         *
         * @param[in] index Element index.
         *
         * @returns Periodic node indices.
         *
         * @throws std::out_of_range if `index` is outside the range [0,`numElements()`).
         */
        ElementList periodicElement(std::size_t index) const;
    };

} // namespace monad
