#pragma once

#include "monad/grid/grid_3d_base.hpp"
#include "monad/fem/element/hex8.hpp"

namespace monad {

    /**
     * @brief 2D grid mesh of 4-node quadrilaterl (Hex8) elements.
     *
     * Example 3x2x2 grid:
     *
     * ```text
     *               oâ”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€o
     *              /         /         /         /â”‚
     *             /         /         /         / â”‚
     *            /         /         /         /  â”‚
     *           oâ”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€o   â”‚
     *          /         /         /         /â”‚   â”‚
     *         /         /         /         / â”‚   o
     *        /         /         /         /  â”‚  /â”‚
     *       oâ”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€o   â”‚ / â”‚
     *       â”‚         â”‚         â”‚         â”‚   â”‚/  â”‚
     *       â”‚         â”‚         â”‚         â”‚   o   â”‚
     *       â”‚         â”‚         â”‚         â”‚  /â”‚   â”‚
     *       â”‚         â”‚         â”‚         â”‚ / â”‚   o
     *       â”‚         â”‚         â”‚         â”‚/  â”‚  /
     *       oâ”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€o   â”‚ /
     *       â”‚         â”‚         â”‚         â”‚   â”‚/
     *       â”‚         â”‚         â”‚         â”‚   o
     *       â”‚         â”‚         â”‚         â”‚  /
     *       â”‚         â”‚         â”‚         â”‚ /
     *       â”‚         â”‚         â”‚         â”‚/
     *       oâ”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€o
     * ```
     *
     * Global axes:
     *
     * - x runs leftâ†’right.
     *
     * - y runs frontâ†’back.
     *
     * - z runs bottomâ†’top.
     */
    class Hex8Grid : public Grid3dBase<Hex8Grid, fem::Hex8> {
    public:
        using Grid3dBase<Hex8Grid, fem::Hex8>::Grid3dBase;

        /// @brief Number of nodes.
        std::size_t numNodes() const noexcept;

        /// @brief Number of periodic nodes.
        std::size_t numPeriodicNodes() const noexcept;

        /**
         * @brief Coordinates for a specific node.
         *
         * Example 3x2x2 grid:
         *
         * ```text
         *               32â”€â”€â”€â”€â”€â”€â”€â”€33â”€â”€â”€â”€â”€â”€â”€â”€34â”€â”€â”€â”€â”€â”€â”€â”€35
         *              /         /         /         /â”‚
         *             /         /         /         / â”‚
         *            /         /         /         /  â”‚
         *           28â”€â”€â”€â”€â”€â”€â”€â”€29â”€â”€â”€â”€â”€â”€â”€â”€30â”€â”€â”€â”€â”€â”€â”€â”€31  â”‚
         *          /         /         /         /â”‚   â”‚
         *         /         /         /         / â”‚   23
         *        /         /         /         /  â”‚  /â”‚
         *       24â”€â”€â”€â”€â”€â”€â”€â”€25â”€â”€â”€â”€â”€â”€â”€â”€26â”€â”€â”€â”€â”€â”€â”€â”€27  â”‚ / â”‚
         *       â”‚         â”‚         â”‚         â”‚   â”‚/  â”‚
         *       â”‚         â”‚         â”‚         â”‚   19  â”‚
         *       â”‚         â”‚         â”‚         â”‚  /â”‚   â”‚
         *       â”‚         â”‚         â”‚         â”‚ / â”‚   11
         *       â”‚         â”‚         â”‚         â”‚/  â”‚  /
         *       12â”€â”€â”€â”€â”€â”€â”€â”€13â”€â”€â”€â”€â”€â”€â”€â”€14â”€â”€â”€â”€â”€â”€â”€â”€15  â”‚ /
         *       â”‚         â”‚         â”‚         â”‚   â”‚/
         *       â”‚         â”‚         â”‚         â”‚   7
         *       â”‚         â”‚         â”‚         â”‚  /
         *       â”‚         â”‚         â”‚         â”‚ /
         *       â”‚         â”‚         â”‚         â”‚/
         *       0â”€â”€â”€â”€â”€â”€â”€â”€â”€1â”€â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€â”€3
         * ```
         *
         * @param[in] index Node index.
         *
         * @returns Coordinates.
         *
         * @throws std::out_of_range if `index` is outside the range [0,`numNodes()`).
         */
        Point node(std::size_t index) const;

        /**
         * @brief Node indices for a specific element.
         *
         * Example 3x2x2 grid:
         *
         * ```text
         *               32â”€â”€â”€â”€â”€â”€â”€â”€33â”€â”€â”€â”€â”€â”€â”€â”€34â”€â”€â”€â”€â”€â”€â”€â”€35
         *              /         /         /         /â”‚
         *             /    ğŸ¿    /    ğŸ·ğŸ¶   /    ğŸ·ğŸ·   / â”‚
         *            /         /         /         /  â”‚
         *           28â”€â”€â”€â”€â”€â”€â”€â”€29â”€â”€â”€â”€â”€â”€â”€â”€30â”€â”€â”€â”€â”€â”€â”€â”€31  â”‚
         *          /         /         /         /â”‚   â”‚
         *         /         /         /         / â”‚   23
         *        /         /         /         /  â”‚  /â”‚
         *       24â”€â”€â”€â”€â”€â”€â”€â”€25â”€â”€â”€â”€â”€â”€â”€â”€26â”€â”€â”€â”€â”€â”€â”€â”€27  â”‚ / â”‚
         *       â”‚         â”‚         â”‚         â”‚   â”‚/  â”‚
         *       â”‚         â”‚         â”‚         â”‚   19  â”‚
         *       â”‚    ğŸ¼    â”‚    ğŸ½    â”‚    ğŸ¾    â”‚  /â”‚   â”‚
         *       â”‚         â”‚         â”‚         â”‚ / â”‚   11
         *       â”‚         â”‚         â”‚         â”‚/  â”‚  /
         *       12â”€â”€â”€â”€â”€â”€â”€â”€13â”€â”€â”€â”€â”€â”€â”€â”€14â”€â”€â”€â”€â”€â”€â”€â”€15  â”‚ /
         *       â”‚         â”‚         â”‚         â”‚   â”‚/
         *       â”‚         â”‚         â”‚         â”‚   7
         *       â”‚    ğŸ¶    â”‚    ğŸ·    â”‚    ğŸ¸    â”‚  /
         *       â”‚         â”‚         â”‚         â”‚ /
         *       â”‚         â”‚         â”‚         â”‚/
         *       0â”€â”€â”€â”€â”€â”€â”€â”€â”€1â”€â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€â”€3
         * ```
         *
         * @param[in] index Element index.
         *
         * @returns Node indices.
         *
         * @throws std::out_of_range if `index` is outside the range [0,`numElements()`).
         */
        ElementList element(std::size_t index) const;

        /**
         * @brief Periodic node indices for a specific element.
         *
         * Example 3x2x2 grid:
         *
         * ```text
         *               0â”€â”€â”€â”€â”€â”€â”€â”€â”€1â”€â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€â”€0
         *              /         /         /         /â”‚
         *             /    ğŸ¿    /    ğŸ·ğŸ¶   /    ğŸ·ğŸ·   / â”‚
         *            /         /         /         /  â”‚
         *           3â”€â”€â”€â”€â”€â”€â”€â”€â”€4â”€â”€â”€â”€â”€â”€â”€â”€â”€5â”€â”€â”€â”€â”€â”€â”€â”€â”€3   â”‚
         *          /         /         /         /â”‚   â”‚
         *         /         /         /         / â”‚   6
         *        /         /         /         /  â”‚  /â”‚
         *       0â”€â”€â”€â”€â”€â”€â”€â”€â”€1â”€â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€â”€0   â”‚ / â”‚
         *       â”‚         â”‚         â”‚         â”‚   â”‚/  â”‚
         *       â”‚         â”‚         â”‚         â”‚   9   â”‚
         *       â”‚    ğŸ¼    â”‚    ğŸ½    â”‚    ğŸ¾    â”‚  /â”‚   â”‚
         *       â”‚         â”‚         â”‚         â”‚ / â”‚   0
         *       â”‚         â”‚         â”‚         â”‚/  â”‚  /
         *       6â”€â”€â”€â”€â”€â”€â”€â”€â”€7â”€â”€â”€â”€â”€â”€â”€â”€â”€8â”€â”€â”€â”€â”€â”€â”€â”€â”€6   â”‚ /
         *       â”‚         â”‚         â”‚         â”‚   â”‚/
         *       â”‚         â”‚         â”‚         â”‚   3
         *       â”‚    ğŸ¶    â”‚    ğŸ·    â”‚    ğŸ¸    â”‚  /
         *       â”‚         â”‚         â”‚         â”‚ /
         *       â”‚         â”‚         â”‚         â”‚/
         *       0â”€â”€â”€â”€â”€â”€â”€â”€â”€1â”€â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€â”€0
         * ```
         *
         * @param[in] index Element index.
         *
         * @returns Periodic node indices.
         *
         * @throws std::out_of_range if `index` is outside the range [0,`numElements()`).
         */
        ElementList periodicElement(std::size_t index) const;
    };

} // namespace monad
